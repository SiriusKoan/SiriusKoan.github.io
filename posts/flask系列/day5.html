<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Day 5 基本 flask 函式 (2)</title>
    <link rel="icon" href="/img/me.jpg">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Alata&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/post.css">
    <link rel="stylesheet" href="/css/common.css">
    <link rel="stylesheet" href="/css/gist.css">
</head>

<body>
    <header>
        <nav>
            <a href="/" class="header-content">SiriusKoan</a>
            <a href="/posts" class="header-content">Posts</a>
            <a href="/about.html" class="header-content">About Me</a>
        </nav>
    </header>
    <a id="top-button" href="#"><span>TOP</span></a>
    <div id="toc">
        <a href="#前言">前言</a>
        <a href="範例一">範例一</a>
        <a href="範例二">範例二</a>
        <a href="#References">References</a>
    </div>
    <main>
        <h1 id="title"><a href="#">Day 5 基本 flask 函式 (2)</a></h1>
        <div class="post_content" id="前言">
            <h2><a href="#前言">前言</a></h2>
            <p>
                今天會繼續探討其他的 flask 的函式。如果說昨天的函式是用來給予使用者回應，那今天提到的函式就是比較偏向接收使用者的請求。
            </p>
        </div>
        <div class="post_content" id="範例一">
            <h2><a href="範例一">範例一</a></h2>
            <p>
                首先來看個小小的例子。
            </p>
            <script src="https://gist.github.com/SiriusKoan/7229469c16e6741f7984f5fcb4c4115c.js"></script>
            <p>
                在 <code>app.py</code> 中，我們 import 了另外一個 module 裡面的 <code>get_url_map</code> 函式，而該函式則呼叫了從 flask 引入的
                <code>current_app</code>，並 print 他的 <code>url_map</code>。
            </p>
            <p>
                這邊的重點就在該 <code>current_app</code>，他會被設定成一開始在 <code>app.py</code> 宣告的 <code>app</code>。要這麼做的原因在於我們無法直接從
                <code>app.py</code> 引入我們設的 <code>app</code>，因為這樣會導致 circular import，所以 flask 提供了這個方法讓我們可以在其他 module 中存取到
                <code>app</code>。
            </p>
        </div>
        <div class="post_content" id="範例二">
            <h2><a href="範例二">範例二</a></h2>
            <p>
                昨天有提到怎麼新增及刪除 cookie，但卻沒有提到如何讀取現在的 cookie，因為他需要用到的不是 <code>resposne</code>，而是
                <code>request</code>，也就是在這個範例要講的概念。不例外地，先從一個範例看起。
            </p>
            <script src="https://gist.github.com/SiriusKoan/aa09218c16becbb6585a243bcc5b394b.js"></script>
            <p>
                這裡面有兩個路徑，第二個跟昨天設定 cookie 是一樣的，比較有趣的是第一個。先看到 <code>request</code> 這個物件，他一樣需要先 import。它代表了現在 flask 收到的
                request，也就是說，在第一個路徑裡使用 <code>request</code> 和在第二個路徑裡使用會有不同的結果。
            </p>
            <p>
                這個 <code>request</code> 內包含了很多資訊，這邊只挑兩個未來會用到的來說，分別是 <code>request.cookies</code> 及
                <code>request.method</code>，其餘的可以參考 <a
                    href="https://tedboy.github.io/flask/generated/generated/flask.Request.html">flask.Request</a>
                或其原始碼。
            </p>
            <ul>
                <li>
                    <code>request.cookies</code> 就是昨天沒有說的「讀取 cookie」的部分，他基本上是一個不可修改的 dict，所以在下面我們使用 dict 的方式
                    (<code>cookies["user"]</code>) 來存取這個 cookie 的值。
                </li>
                <li>
                    <code>request.method</code> 是一個字串，就是存取的 HTTP method，以此路徑為例，只有 <code>GET</code>、<code>POST</code>
                    兩種可能 (在 <code>app.route()</code> 定義過了)，所以在下方的判斷就只做這兩個。這個方式非常常用，基本上每一個路徑都會用到。
                </li>
            </ul>
            <p>
                除了上述這幾個之外，<code>request.form</code> 也很常用，顧名思義，他就是處理使用者提交的表單，但因為我們之後會使用 Flask-WTF，不會直接操作到他，所以暫時不提。
            </p>
        </div>
        <div class="post_content attachment" id="References">
            <h2><a href="#References">References</a></h2>
            <a href="https://stackoverflow.com/questions/10434599/get-the-data-received-in-a-flask-request">Get the data received in a Flask request</a>
        </div>
    </main>
    <footer>
        <p id="copyright">© 2021 <a href="https://github.com/SiriusKoan" target="_blank">SiriusKoan</a></p>
    </footer>
</body>

</html>