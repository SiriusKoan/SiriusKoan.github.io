<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Day 19 實作表單 (2)</title>
    <link rel="icon" href="/img/me.jpg">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Alata&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/post.css">
    <link rel="stylesheet" href="/css/common.css">
    <link rel="stylesheet" href="/css/gist.css">
</head>

<body>
    <header>
        <nav>
            <a href="/" class="header-content">SiriusKoan</a>
            <a href="/posts" class="header-content">Posts</a>
            <a href="/about.html" class="header-content">About Me</a>
        </nav>
    </header>
    <a id="top-button" href="#"><span>TOP</span></a>
    <div id="toc">
        <a href="#前言">前言</a>
        <a href="#posts&comments">posts & comments</a>
        <a href="#UserSettingForm">UserSettingForm</a>
        <a href="#AddUserForm">AddUserForm</a>
        <a href="#References">References</a>
    </div>
    <main>
        <h1 id="title"><a href="#">Day 19 實作表單 (2)</a></h1>
        <div class="post_content" id="前言">
            <h2><a href="#前言">前言</a></h2>
            <p>
                今天要來接續製作表單，會以昨天的內容再延伸出更多新的功能。
            </p>
        </div>
        <div class="post_content" id="UserSettingForm">
            <h2><a href="#UserSettingForm">UserSettingForm</a></h2>
            <p>
                昨天有了登入和註冊，今天就來加上使用者設定的表單。
            </p>
            <script src="https://gist.github.com/SiriusKoan/1fbc325d81202ffe895aa7e392f28275.js"></script>
            <p>
                他也有三個欄位，分別是密碼、電子郵件、送出。前面的設定基本上都跟昨天差不多，比較特殊的是最後面的 <code>validate_password</code>。
            </p>
            <p>
                昨天講了很多 <code>validators</code>，而 <code>validate_password</code>
                也可以算是一個，只是他會用一個函式的方式來處理。他的函式名稱並不像看起來這麼簡單，<code>password</code> 指的不只是我們語意上的密碼，同時也是我們上面定義的
                <code>password</code> 欄位。Flask-WTF 可以用這種 <code>validate_{field_name}</code> 函式來做一些沒辦法用一般他提供的 validator
                的驗證，而它裡面的 <code>field</code> 就是指定的欄位，以此處為例就是 <code>self.password</code>。
            </p>
            <p>
                因為這個表單是二合一的，使用者可能只想改密碼或是電子郵件，所以我們不會讓他 <code>DataRequired</code> (<code>email</code>
                有的原因是我們到時候會直接把電子郵件送到前端顯示，但密碼不能這樣做)，但是密碼還是有它該驗證的東西，所以我們加上這個函式來處理。他首先判斷他的型別是否正常，接著看看他是不是空字串，如果是的話就不要理他，這代表他沒有要改的意思；如果不是的話，那就要看看他是不是有超過六碼。這裡有一個
                <code>ValidationError</code>，他要從 <code>wtforms.validators</code> 引入，跟昨天那一堆 validator 同一個地方，而他參數的字串就是要顯示的訊息。
            </p>
        </div>
        <div class="post_content" id="AddUserForm">
            <h2><a href="#AddUserForm">AddUserForm</a></h2>
            <p>
                接著來看看管理員的新增使用者表單。
            </p>
            <script src="https://gist.github.com/SiriusKoan/66c9af6b1317fe5b80711a5d72960972.js"></script>
            <p>
                跟之前註冊的很像，比較特別的是他有一個 <code>BooleanField</code>，他到了 HTML 會變成常見的 checkbox，就可以讓管理員透過這個來調整要不要讓使用者變成管理員。而他需要另外引入，跟前面都不太一樣，他要從 <code>wtforms.fields.core</code> 引入。
            </p>
        </div>
        <div class="post_content" id="posts&comments">
            <h2><a href="#posts&comments">posts & comments</a></h2>
            <p>
                最後要來看到新增貼文和留言的表單。
            </p>
            <script src="https://gist.github.com/SiriusKoan/81a6b84fa7673df7c9f685e0515dff94.js"></script>
            <p>
                留言的表單沒甚麼好說，非常簡單易懂。比較特別的是貼文的表單，我們用了一個新東西 <code>PageDownField</code>，他允許我們邊編輯邊看 markdwon 長甚麼樣子，這個東西現在不會解釋，會等到寫 HTML 的時候再來處理。
            </p>
        </div>
        <div class="post_content attachment" id="References">
            <h2><a href="#References">References</a></h2>
            <a href="https://hackmd.io/@shaoeChen/HJSpC9l6f?type=view">Flask實作_ext_13_Flask-Markdown</a>
            <a href="https://wtforms.readthedocs.io/en/2.3.x/fields/#wtforms.fields.BooleanField">BooleanField</a>
        </div>
    </main>
    <footer>
        <p id="copyright">© 2021 <a href="https://github.com/SiriusKoan" target="_blank">SiriusKoan</a></p>
    </footer>
</body>

</html>
