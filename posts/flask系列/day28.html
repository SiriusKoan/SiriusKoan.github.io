<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Day 28 實作 admin_bp (1)</title>
    <link rel="icon" href="/img/me.jpg">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Alata&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/post.css">
    <link rel="stylesheet" href="/css/common.css">
    <link rel="stylesheet" href="/css/gist.css">
</head>

<body>
    <header>
        <nav>
            <a href="/" class="header-content">SiriusKoan</a>
            <a href="/posts" class="header-content">Posts</a>
            <a href="/about.html" class="header-content">About Me</a>
        </nav>
    </header>
    <a id="top-button" href="#"><span>TOP</span></a>
    <div id="toc">
        <a href="#前言">前言</a>
        <a href="#/admin_dashboard/posts">/admin_dashboard/posts</a>
        <a href="#/admin_dashboard/comments">/admin_dashboard/comments</a>
        <a href="#/manage_user">/manage_user</a>
    </div>
    <main>
        <h1 id="title"><a href="#">Day 28 實作 admin_bp (1)</a></h1>
        <div class="post_content" id="前言">
            <h2><a href="#前言">前言</a></h2>
            <p>
                今天要開始寫 <code>admin_bp</code>，有蠻多部分跟之前很像。
            </p>
        </div>
        <div class="post_content" id="/admin_dashboard/posts">
            <h2><a href="#/admin_dashboard/posts">/admin_dashboard/posts</a></h2>
            <p>
                先來看看 HTML 的部分。
            </p>
            <script src="https://gist.github.com/SiriusKoan/748ee89ed99143bbb18a14436f82394f.js"></script>
            <p>
                基本上跟一般使用者的 dashboard 差不多，但 <code>form</code> 的部分新加入了一個 <code>user_id</code> 的欄位。在最後面有一個刪除的按鈕，它今天還不會登場。
            </p>
            <p>
                接下來進入路徑的部分，也一樣跟使用者的 dashboard 類似，因為都有篩選器。
            </p>
            <script src="https://gist.github.com/SiriusKoan/a0223892a54ad97b22b78ace1ee923c2.js"></script>
            <p>
                基本上就是直接從使用者 dashboard 抄過來的，只是多加一個 <code>user_id</code> 而已。但還是有一個小東西要注意一下，在拉出 <code>user_id</code> 的時候要把他轉成字串，不然會噴錯誤。
            </p>
        </div>
        <div class="post_content" id="/admin_dashboard/comments">
            <h2><a href="#/admin_dashboard/comments">/admin_dashboard/comments</a></h2>
            <p>
                接著來到留言的 dashboard，跟剛剛也是很接近，但要先來加一個資料庫的函式。
            </p>
            <script src="https://gist.github.com/SiriusKoan/016b06a767dbf5d0c5b1bf29fbab732b.js"></script>
            <p>
                基本上就是把 <code>get_posts</code> 拿來這邊改一下而已。
            </p>
            <p>
                接下來是他的 HTML。
            </p>
            <script src="https://gist.github.com/SiriusKoan/5edec72d8b4d48b5c2e389f5fe3547c0.js"></script>
            <p>
                表單也是一樣的，就是篩選器。跟剛剛一樣，他也有刪除的按鈕。
            </p>
            <p>
                最後來到路徑的部分。
            </p>
            <script src="https://gist.github.com/SiriusKoan/efd466d8bfcec3751002683818b40c80.js"></script>
            <p>
                跟剛剛幾乎一模一樣，只是把貼文換成留言而已。
            </p>
        </div>
        <div class="post_content" id="/manage_user">
            <h2><a href="#/manage_user">/manage_user</a></h2>
            <p>
                在今天的最後，我們要處理管理使用者的介面。一樣先從資料庫部分看起。
            </p>
            <script src="https://gist.github.com/SiriusKoan/18bfb60295e7bd2cda5073c3c6909a9e.js"></script>
            <p>
                基本上都跟剛剛很接近，只是這裏我們用已經寫好的 <code>user_to_dict</code> 取代剛剛的 list comprehension。
            </p>
            <p>
                接著是 HTML 的部分，基本上也蠻類似的。
            </p>
            <script src="https://gist.github.com/SiriusKoan/91b74a0481d1aa7f98a5de5097b22300.js"></script>
            <p>
                稍微不一樣的是我們把單純的顯示出來變成了 <code>input</code>，這樣管理員才可以直接修改，裡面沒有加上密碼的欄位，因為太煩了，而且也是可以想到的東西，就不在這邊做。還有一個不一樣的地方是 <code>user['is_admin']</code> 的部分，我們在那裏用了一個 if 來判斷他是不是管理員，如果是的話就把那個 checkbox 勾起來。
            </p>
            <p>
                最後要看的是路徑本身，基本上就是跟前面兩個相同。
            </p>
            <script src="https://gist.github.com/SiriusKoan/cad39aac77ed834d931a46d90e6c3a5d.js"></script>
            <p>
                要記得把 <code>form</code> 改掉，也要記得多一個欄位 <code>username</code>。
            </p>
        </div>
    </main>
    <footer>
        <p id="copyright">© 2021 <a href="https://github.com/SiriusKoan" target="_blank">SiriusKoan</a></p>
    </footer>
</body>

</html>
